<%= ds.error_messages %>
<fieldset>
  <legend><b>Basic Info</b></legend>
  <p>
    
    <%= ds.label :title %> <%= ds.text_field :title, :disabled=>!@datasource.new_record? %>
  </p>
  <p>
    <%= ds.label :data_type_id, 'Data Type' %><br/>
    <input class="property-type-qualified-name" name="qualified_name" size="30" type="text" value="<%= @datasource.data_type.name if @datasource.data_type %>"/>
    <%= ds.hidden_field :data_type_id %>
  </p>				
  <%= ds.fields_for :metadata, @datasource.metadata do |m| %>
  <p><%= m.label :description %><br/> <%= m.text_area :description, :rows => 3 %></p>
  <p><%= m.label :keywords, 'Keywords (separated by commas)' %><br/> <%= m.text_area :keywords, :rows => 3, 
                  :value=>@datasource.metadata ? @datasource.metadata.keywords.join(', ') : '' %></p>
  <p class="date"><%= m.label :last_updated %> <%= m.text_field :last_updated %></p>
  <% end %>				
</fieldset>	 	

<fieldset id="source">
  <legend><b>Source</b></legend>
  <%= ds.fields_for :source, @datasource.source do |s| %>
  <p>
    <%= s.label :source_type %>
    <%= s.select :source_type, OpenMedia::Datasource::TYPES.collect {|t| [t.titleize, t]} %>
  </p>

  <p id="parser">
    <%= s.label :parser %>
    <%= s.select :parser, OpenMedia::Datasource::PARSERS.collect {|p| [p.titleize, p]} %>
  </p>

  <p>
    <%= s.label :column_separator %>
    <%= s.text_field :column_separator %>
  </p>

  <p>
    <%= s.label :skip_lines %>
    <%= s.text_field :skip_lines %>
  </p>

  <% for property in @datasource.source.source_properties %>
  <%= render :partial=>'schema/types/property', :locals=>{ :base_name=>'datasource[source][source_properties][]', :property=>property } %>
  <% end %>
  <a href="#" class="add-property" rel="datasource[source][source_properties][]">add property</a>
  <% end %>
</fieldset>	 	
